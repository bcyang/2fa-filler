# 2FA Auto Filler Chrome Extension

A Chrome extension that automatically fills 2FA (Two-Factor Authentication) prompts using TOTP (Time-based One-Time Password) secrets. Currently supports Okta and Microsoft authentication.

The intial codes were generated by cursor (https://www.cursor.com/). See the README-cursor.md for a "proper" README


## Installation

For Chrome Extension, I feel it's actually better that you get the source codes and load the unpacked.
Not only is it easy and persistent, most importantly, you get to see the codes.

Remember to `Pin to toolbar` in the Extension Detail page, as you need that to `Add Secrets`

## 2FA

You can read more about how 2FA is done. But in a nushell, 

1. service (say example.com) generates a 10-byte secret for, say, jerry@mist.com
2. it generates the QRcode with content `otpauth://totp/example.com:jerry%40mist.com?secret=<base32-encoded secret>&issuer=example.com`
3. your 2FA app (e.g. Google Authenticator) stores the secret
4. your 2FA app can then generate 6-digit code from `extract_and_encode_part_of(hmac_sha1(secret, epoch_in_seconds / 30))`


## Setup / Add Secrets

This may be the most troublesome part of the setup.

As you can imagine, neither `example.com` nor `Google Authenticator` wants to expose the secret. I would have made the same design/implementation choice. User simply do not need to see this and it has huge security implications.

That means - you would have to setup it up again.

For Okta, login to xxxx.okta.com with your account, remove your Google Authenticator and set it up again. You'd then get a new QR Code, take a screenshot in case you navigate away.

First, set it up like you would in your Google Authenticator.
Second, use a QR Code reader (many apps on iOS or Andriod) to see the embedded URL `otpauth://totp/...` and copy the `<base32-encoded secret>` out of it and add that to the extension.

To test it, open the `test-2fa.html` and you should see the code generated under the corresponding service and it should match what you have in your Google Authenticator

## Footnotes

#### The experience with `Cursor`
It did a goog job in the beginning. Creating all the necessary files, built the popup to manage secrets (using storage) and use messaging between content.js and background.js (service) for cleaner separation of front/backend. However,

1. the TOTP generation code is wrong (the bit manipulation looks cryptic and result is wrong). I end up having GPT generate a code in its place (well, GPT's logic is right but has a syntax error, too)
2. I asked cursor to tweak something, it ended up regenerate lots of codes and wiped out some of my changes. I wasn't super-suprised as this is what GenAI does. Whatever backend you use, it doesn't really have a state of mind.
3. It tends not to do any clean-ups of the "littering" (intermediate stuff it generates when I ask it to do something - additional node packages, ...). I suppose this is not in GenAI's priority either.

All in all, though, I'd give it a thump up - this allows me to crank out another useful tool for myself in an hour or two.
